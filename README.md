网上找了两套代码，踩过N个坑，现终于调试成功，放上来，供参考学习。
哥毫无保留的奉上，之前上传的不全，或许有些私心，后来过了一年两再想看看时，
结果把自己坑了，从此以后，哥毫无保留。